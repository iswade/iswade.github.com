
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://iswade.github.io/01_database_notes/">
      
      <link rel="icon" href="../themes/me.svg">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Database Notes - iswade's blog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../themes/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="white" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#database-notes" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href=".." title="iswade&#39;s blog" class="md-header__button md-logo" aria-label="iswade's blog" data-md-component="logo">
      
  <img src="../themes/me.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            iswade's blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Database Notes
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="iswade&#39;s blog" class="md-nav__button md-logo" aria-label="iswade's blog" data-md-component="logo">
      
  <img src="../themes/me.svg" alt="logo">

    </a>
    iswade's blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        主页
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          数据库
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="数据库" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          数据库
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notes/adb_nodes/00_index/" class="md-nav__link">
        高级数据库笔记
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../articles/buffer/buffer_details/" class="md-nav__link">
        PostgreSQL缓存
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/crdb/crdb_paper_cn/" class="md-nav__link">
        CockroachDB翻译
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/crdb/crdb_paper/" class="md-nav__link">
        CockroachDB论文
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/taurus_paper_cn/" class="md-nav__link">
        TaurusDB翻译
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/taurus_paper/" class="md-nav__link">
        TaurusDB论文
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../articles/pebble/" class="md-nav__link">
        Pebble KV存储引擎
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/faunadb_transaction/" class="md-nav__link">
        FaunaDB分布式事务协议
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/Aurora_design_cloud_native_database/" class="md-nav__link">
        Aurora云原生关系数据库
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/btree_vs_lsmtree/" class="md-nav__link">
        现代存储系统背后的算法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notes/db_nodes/00_database_systems_2018/" class="md-nav__link">
        数据库笔记
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/F1_query/" class="md-nav__link">
        F1 Query
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          分布式系统
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="分布式系统" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          分布式系统
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/distsys/" class="md-nav__link">
        分布式系统大纲
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../articles/partition/" class="md-nav__link">
        数据分区
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/strong_consistency_models/" class="md-nav__link">
        强一致性模型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/zookeeper/" class="md-nav__link">
        Zookeeper论文翻译
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/paxos_made_live/" class="md-nav__link">
        Paxos Made Live翻译
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          编程语言
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="编程语言" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          编程语言
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../articles/go_concurrency/" class="md-nav__link">
        Go并发编程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/go_interface/" class="md-nav__link">
        如何使用Go接口
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          软件工程
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="软件工程" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          软件工程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notes/pragmatic_programmer/" class="md-nav__link">
        程序员修炼之道
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notes/bash_turorial/" class="md-nav__link">
        bash教程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/linux_sysadmin/" class="md-nav__link">
        linux系统管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notes/git/" class="md-nav__link">
        git入门教程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../translate/to_be_manager/" class="md-nav__link">
        How to be a manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    专项
  </a>
  
    <nav class="md-nav" aria-label="专项">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    顶级会议
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    分布式系统
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    一致性与共识
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharding" class="md-nav__link">
    sharding 相关
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    并行查询
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    编译器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    扩容
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turing-award" class="md-nav__link">
    Turing Award
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    misc
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    关注
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    书籍
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    文章
  </a>
  
    <nav class="md-nav" aria-label="文章">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    分布式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newsql" class="md-nav__link">
    NewSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    其它
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    论文
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    实例汇总
  </a>
  
    <nav class="md-nav" aria-label="实例汇总">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#taurusdb" class="md-nav__link">
    TaurusDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snowflake" class="md-nav__link">
    Snowflake
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cockroachdb" class="md-nav__link">
    CockroachDB
  </a>
  
    <nav class="md-nav" aria-label="CockroachDB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cockroachdb_1" class="md-nav__link">
    迁移到CockroachDB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    阿里巴巴
  </a>
  
    <nav class="md-nav" aria-label="阿里巴巴">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#oceanbase" class="md-nav__link">
    OceanBase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x-paxos" class="md-nav__link">
    X-Paxos: 复制库
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql" class="md-nav__link">
    MySQL
  </a>
  
    <nav class="md-nav" aria-label="MySQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mysql-group-replication" class="md-nav__link">
    MySQL Group Replication
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tikv" class="md-nav__link">
    TiKV
  </a>
  
    <nav class="md-nav" aria-label="TiKV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 共识算法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-kv" class="md-nav__link">
    3. KV引擎
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. 分布式事务
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. 伸缩性
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microsoft" class="md-nav__link">
    Microsoft
  </a>
  
    <nav class="md-nav" aria-label="Microsoft">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-new-sql-server-in-the-cloud" class="md-nav__link">
    The New SQL Server in the Cloud
  </a>
  
    <nav class="md-nav" aria-label="The New SQL Server in the Cloud">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1. 介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2. 现有技术
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anna" class="md-nav__link">
    Anna
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#faunadb" class="md-nav__link">
    FaunaDB
  </a>
  
    <nav class="md-nav" aria-label="FaunaDB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#faunadb-an-architectural-overview" class="md-nav__link">
    FaunaDB: An Architectural Overview
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calvin" class="md-nav__link">
    Calvin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#voltdb" class="md-nav__link">
    VoltDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aurora" class="md-nav__link">
    Aurora
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spanner" class="md-nav__link">
    Spanner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    SQL 数据库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    分布式数据库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    数据仓库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nosql" class="md-nav__link">
    NoSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    多模数据库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    未来技术方向
  </a>
  
    <nav class="md-nav" aria-label="未来技术方向">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#newsql_1" class="md-nav__link">
    NewSQL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    算法
  </a>
  
    <nav class="md-nav" aria-label="算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crdt" class="md-nav__link">
    CRDT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    无锁
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" class="md-nav__link">
    hash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    并行原理
  </a>
  
    <nav class="md-nav" aria-label="并行原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    并行方式
  </a>
  
    <nav class="md-nav" aria-label="并行方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpp-join" class="md-nav__link">
    MPP 并行 JOIN
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    JOIN
  </a>
  
    <nav class="md-nav" aria-label="JOIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    连接顺序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    连接方式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    连接算法
  </a>
  
    <nav class="md-nav" aria-label="连接算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nested-loop" class="md-nav__link">
    nested loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash-join" class="md-nav__link">
    hash join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge-join" class="md-nav__link">
    merge join
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-by" class="md-nav__link">
    GROUP BY
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    未来方向
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="database-notes">Database Notes</h1>
<p>标签：数据库</p>
<h2 id="_1">专项</h2>
<h3 id="_2">顶级会议</h3>
<ul>
<li>SIGMOD: ACM SIGMOD Conf on Management of Data</li>
<li>VLDB: Very Large Data Bases</li>
<li>OSDI：系统领域</li>
<li>SOSP：系统领域</li>
<li>FAST2020</li>
</ul>
<h3 id="_3">分布式系统</h3>
<ol>
<li><a href="https://www.cs.vu.nl/~tcs/da/daslides.pdf">Distributed Algorithms: An Intuitive Approach </a></li>
<li><a href="https://www.distributed-systems.net/index.php/books/distributed-systems-3rd-edition-2017/">Distributed Systems Third edition Maarten van Steen</a></li>
<li>Distributed.Systems.An.Algorithmic.Approach.2<sup>nd</sup>.Edition</li>
<li>2010 Scalability patterns(slides).pdf</li>
<li><a href="https://www.somethingsimilar.com/2013/01/14/notes-on-distributed-systems-for-young-bloods/">https://www.somethingsimilar.com/2013/01/14/notes-on-distributed-systems-for-young-bloods/</a></li>
</ol>
<h3 id="_4">一致性与共识</h3>
<ul>
<li><a href="https://jepsen.io/consistency">https://jepsen.io/consistency</a> 各种一致性和隔离级别的汇总</li>
<li>DDIA 中一致性和共识的详细内容，有很多深刻的结论，例如如下的问题都是与共识问题是等价的
  Linearizable compare-and-set registers
  Atomic transaction commit
  Total order broadcast
  Locks and leases
  Membership/coordination service
  Uniqueness constraint</li>
<li><a href="http://raft.github.io/">raft</a> 当前需要重点深入理解的协议</li>
<li><a href="https://www.cs.cornell.edu/fbs/publications/SMSurvey.pdf">Implementing fault-tolerant services using the state machine approach</a> 2000多引用 </li>
<li><a href="https://dl.acm.org/citation.cfm?id=62549">Viewstamped Replication: A New Primary Copy Method to Support Highly-Available Distributed Systems</a></li>
<li><a href="https://jepsen.io/analyses/faunadb-2.5.4">faunadb jepsen测试</a> </li>
<li><a href="https://jepsen.io/consistency">https://jepsen.io/consistency</a> 各种一致性的定义</li>
<li><a href="https://arxiv.org/abs/1902.06776">A Generalised Solution to Distributed Consensus</a> </li>
<li><a href="https://news.ycombinator.com/item?id=19343398">hckernew讨论</a></li>
<li><a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-935.html">Distributed consensus revised</a> 博士论文</li>
<li><a href="https://arxiv.org/abs/1802.07000">CASPaxos: Replicated State Machines without logs</a></li>
<li><a href="https://www.jianshu.com/p/3673e612cce2">一致性模型</a></li>
<li><a href="http://loopjump.com/distributed_consistency_model/">浅析分布式一致性模型</a></li>
</ul>
<p>外部一致性和可线性化还是有差异的：
外部一致性保证系统处理事务调度顺序与外部调度等价。
线性化保证单个对象写入后读取到的一定是最新的。</p>
<ul>
<li><a href="http://dl.acm.org/citation.cfm?id=320076">A majority consensus approach to concurrency control for multiple copy databases</a> 1380多次引用</li>
<li><a href="https://irenezhang.net/blog/2015/02/01/consistency.html">Consistency should be more consistent!</a></li>
</ul>
<p><strong>Sequential (or serializable) consistency</strong> ensures that the same operations are applied in the same order to every copy of a set of data items. <strong>顺序/序列化一致性</strong>确保以相同的顺序将相同的操作应用于一组数据项的每个副本。</p>
<p><strong>Serializable isolation</strong> ensures that transactions execute as if they were executing one at a time on a single copy of the database. <strong>可序列化隔离</strong>确保事务执行就好像它们在数据库的单个副本上一次执行一个。</p>
<p><strong>Linearizable consistency</strong> ensures that the same operations are applied in the same order to every copy of the data item and that the order reflects the order in which the operations <em>appear</em> to execute to an external observer (like the application). <strong>可线性化的一致性</strong>确保以相同的顺序对数据项的每个副本应用相同的操作，并且该顺序反映了操作<em>出现</em>对外部观察者（如应用程序）执行的顺序。</p>
<p><strong>Strict serializable isolation</strong> ensures that transactions execute as if they were executing one at a time on a single copy of the database and that the order matches the order in which the transactions <em>appear</em> to execute to an external observer (like the application). <strong>严格的可序列化隔离</strong>确保事务执行就好像它们在数据库的单个副本上一次执行一个，并且顺序与事务<em>出现</em>的顺序匹配，以执行外部观察者（如 应用）。</p>
<p>There has been much discussion of externally consistent (or linearizable) transactions since the publication of Google’s Spanner system [2]. Traditionally, the guarantees provided by Spanner and applied to transactions would be called strict serializability. Practically, it doesn’t matter: <em>linearizability is just strict serializability for single operations.</em> 自Google的Spanner系统发布以来，对外部一致（或线性化）事务进行了大量讨论。传统上，Spanner提供并应用于事务的保证称为严格可序列化。 实际上，它并不重要：<em>线性化只是单个操作的严格可序列化。</em></p>
<p><a href="http://bitsavers.org/pdf/xerox/parc/techReports/CSL-81-8_Information_Storage_in_a_Decentralized_Computer_System.pdf">Information storage in a decentralized computer system</a>
外部一致性的定义：External Consistency. External consistency guarantees that a transaction will always receive current information. Using the concepts we have just introduced, we can provide a formal definition of external consistency. The actual time order in which transactions complete defines a unique serial schedule. This serial schedule is called the external schedule. A system is said to provide external consistency if it guarantees that the schedule it will use to process a set of transactions is equivalent to its external schedule. </p>
<p><a href="https://cs.brown.edu/~mph/HerlihyW90/p463-herlihy.pdf"> Linearizability: A Correctness Condition for Concurrent Objects</a>
线性化的定义：</p>
<h3 id="sharding">sharding 相关</h3>
<p>分布式数据处理系统第一个要解决的问题就是如何将数据进行拆分，利用多台计算机处理大规模数据。对于数据量很大的数据集，单机无法保存或者处理时，通过对数据集进行水平拆分，将不同的数据子集存放到不同的处理节点，这种对数据进行拆分的方式叫做分片（sharding）。不同数据库中对分区的名称定义有所差异，有些称之为分区（partition），还有一些称之为区域（Region），但是其含义都是基本相同的。需要注意的是，这里的分区跟CAP中的网络分区和单机的单机分区表没有关系。</p>
<p>数据库分片是数据的水平分区。每个分片都保存在单独的数据库服务器实例上，以分散负载。数据库中的某些数据仍然存在于所有分片中，但有些数据仅出现在单个分片中。每个分片都作为数据库子集的一个源。</p>
<p>水平分区是将一个表的数据的行分为不同的分片保存，每个分片上的表模式完全相同。不同于垂直分区，垂直分区将表模式拆分为不同的列，例如通过范式做数据库设计时的拆分。</p>
<p>对数据分片有许多优点：
由于表被分割并分布到多个服务器中，因此减少了每个数据库中每个表中的总行数，这通常可以提高搜索性能。数据库分片可以放在单独的硬件上，多个分片可以放在多台机器上。这使得能够在大量机器上分发数据，从而大大提高了性能。另外，如果数据库分片基于数据的一些真实世界分段（例如，一个国家，一个省份的数据放在不同的分片上），则容易自动分发查询到适当的分片，仅查询相关分片。</p>
<p>当然对数据分片之后，也有很多的缺点：</p>
<ol>
<li>首先就是跨分片事务，通常可以通过2PC解决，但是2PC在一些故障场景下可能会阻塞业务，需要人工干预，同时2PC大量使用也会导致性能问题。</li>
<li>如果业务对一致性要求较高，则需要实现全局一致性，需要中心节点来获取时间，或者全局事务ID，中心节点可能会成为瓶颈。</li>
<li>还有一些问题就是跨分片的连接、分组聚合、子查询等等，大部分数据库只能提供部分算子的优化，其它算子则性能很差，这种场景下则需要业务侧权衡是否适用于当前业务。</li>
<li>随着数据和业务的增长，可能会出现数据倾斜问题，导致不同分片之间的负载不同。</li>
<li>数据量增加到某个分片的阈值容量之后，需要做扩容，迁移大量数据，可能会长时间导致业务不可用，实现不中断的在线扩容也是很大挑战之一。</li>
<li>其它：如分片间的唯一索引，外键，单机类似的连续序列等都无法支持。</li>
</ol>
<h3 id="_5">并行查询</h3>
<ul>
<li><a href="https://yq.aliyun.com/articles/684431">PostgreSQL 并行查询概述</a></li>
<li><a href="https://db.in.tum.de/teaching/ss14/moderndbs/chapter7.pdf?lang=de">https://db.in.tum.de/teaching/ss14/moderndbs/chapter7.pdf?lang=de</a></li>
<li><a href="http://infocenter.sybase.com/help/topic/com.sybase.infocenter.dc00743.1570/html/queryprocessing/CHDGHJBC.htm">http://infocenter.sybase.com/help/topic/com.sybase.infocenter.dc00743.1570/html/queryprocessing/CHDGHJBC.htm</a></li>
<li>Design and Evaluation of Main Memory Hash Join Algorithms for Multi-core CPUs</li>
<li>The Volcano Optimizer Generator: Extensibility and Efficient Search</li>
<li>Encapsulation of Parallehsm in the Volcano Query Processmg System</li>
<li><a href="https://www.percona.com/blog/2019/02/21/parallel-queries-in-postgresql/">https://www.percona.com/blog/2019/02/21/parallel-queries-in-postgresql/</a></li>
<li><a href="https://www.postgresql.eu/events/pgconfeu2018/sessions/session/2140/slides/141/PQ_PGCON_EU_2018.pdf">https://www.postgresql.eu/events/pgconfeu2018/sessions/session/2140/slides/141/PQ_PGCON_EU_2018.pdf</a></li>
<li><a href="https://www.pgcon.org/2017/schedule/attachments/455_pgcon-2017-hash-joins.pdf">https://www.pgcon.org/2017/schedule/attachments/455_pgcon-2017-hash-joins.pdf</a></li>
<li><a href="https://www.postgresql.org/docs/11/parallel-plans.html">https://www.postgresql.org/docs/11/parallel-plans.html</a></li>
<li><a href="https://www.enterprisedb.com/blog/parallel-hash-postgresql">https://www.enterprisedb.com/blog/parallel-hash-postgresql</a></li>
<li><a href="http://pages.cs.wisc.edu/~dewitt/includes/paralleldb/sigmod89.pdf">http://pages.cs.wisc.edu/~dewitt/includes/paralleldb/sigmod89.pdf</a></li>
<li><a href="http://ceur-ws.org/Vol-735/paper10.pdf">http://ceur-ws.org/Vol-735/paper10.pdf</a></li>
<li><a href="https://en.wikipedia.org/wiki/Amdahl%27s_law">https://en.wikipedia.org/wiki/Amdahl%27s_law</a> </li>
<li><a href="https://www.sqlshack.com/parallel-nested-loop-joins-the-inner-side-of-nested-loop-joins-and-residual-predicates/">https://www.sqlshack.com/parallel-nested-loop-joins-the-inner-side-of-nested-loop-joins-and-residual-predicates/</a></li>
<li><a href="https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/gg415714(v=msdn.10">https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/gg415714(v=msdn.10</a>)</li>
<li><a href="http://pages.cs.wisc.edu/~dewitt/includes/paralleldb/vldb92.pdf">http://pages.cs.wisc.edu/~dewitt/includes/paralleldb/vldb92.pdf</a></li>
<li><a href="http://www.dcs.ed.ac.uk/home/tz/phd/thesis/node12.htm">http://www.dcs.ed.ac.uk/home/tz/phd/thesis/node12.htm</a></li>
<li><a href="https://15721.courses.cs.cmu.edu/spring2016/papers/p37-blanas.pdf">https://15721.courses.cs.cmu.edu/spring2016/papers/p37-blanas.pdf</a></li>
<li>HadoopDB MPP and MapReduce</li>
<li><a href="http://www.vldb.org/pvldb/2/vldb09-861.pdf">http://www.vldb.org/pvldb/2/vldb09-861.pdf</a></li>
</ul>
<p>阿姆达尔定律（英语：Amdahl's law，Amdahl's argument），一个计算机科学界的经验法则，因吉恩·阿姆达尔而得名。它代表了处理器并行运算之后效率提升的能力。当并行度提升到一定程度之后，一定存在某种程度的争用，导致效率无法继续提升。</p>
<h3 id="_6">编译器</h3>
<ul>
<li><a href="https://tiarkrompf.github.io/index.html">作者Tiark  Rompf的主页</a></li>
<li><a href="https://www.cs.purdue.edu/homes/rompf/papers/rompf-icfp15.pdf">Functional Pearl: A SQL to C Compiler in 500 Lines of Code</a></li>
<li><a href="">How to Architect a Query Compiler, Revisited</a></li>
<li><a href="https://15721.courses.cs.cmu.edu/spring2018/papers/03-compilation/shaikhha-sigmod2016.pdf">How to Architect a Query Compiler</a></li>
</ul>
<h3 id="_7">扩容</h3>
<div class="codehilite" style="background: #002b36"><pre style="line-height: 125%"><span></span><code><span style="color: #839496; background-color: #dc322f">MPPDB公开论文中的算法</span>
<span style="color: #839496; background-color: #dc322f">Algorithm 1 Algorithm Redistribution DML</span>
<span style="color: #839496; background-color: #dc322f"> 1: 建立一个shadow表S，与原始表T的模式一样</span>
<span style="color: #839496; background-color: #dc322f"> 2: 将表T作为append-only模式</span>
<span style="color: #839496; background-color: #dc322f"> 3: 设置T不进行垃圾回收</span>
<span style="color: #839496; background-color: #dc322f"> 4: 建立T表删除数据的 delete-delta 表D</span>
<span style="color: #839496; background-color: #dc322f"> 5: 将T中的数据段重分布到S</span>
<span style="color: #839496; background-color: #dc322f"> 6: 将D中的数据应用到S中</span>
<span style="color: #839496; background-color: #dc322f"> 7: 提交变更</span>
<span style="color: #839496; background-color: #dc322f"> 8: 重复5-7知道T中的数据小于阈值</span>
<span style="color: #839496; background-color: #dc322f"> 9: 锁定原始表，重分布剩余的插入和删除的增量，与5-6一致</span>
<span style="color: #586e75; font-style: italic">10: 将表T在系统表中转换为S</span>
<span style="color: #586e75; font-style: italic">11: 提交变更</span>
<span style="color: #586e75; font-style: italic">12: 重建索引</span>
</code></pre></div>


<h3 id="turing-award">Turing Award</h3>
<table>
<thead>
<tr>
<th>姓名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Charles_Bachman">Charles W. Bachman</a></td>
<td>For his outstanding contributions to <a href="https://en.wikipedia.org/wiki/Database">database</a> technology.</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Edgar_F._Codd">Edgar F. Codd</a></td>
<td>For his fundamental and continuing contributions to the theory and practice of database management systems, esp. <a href="https://en.wikipedia.org/wiki/Relational_database">relational databases</a>.</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Jim_Gray_(computer_scientist)">Jim Gray</a></td>
<td>For seminal contributions to <a href="https://en.wikipedia.org/wiki/Database">database</a> and <a href="https://en.wikipedia.org/wiki/Transaction_processing">transaction processing</a>research and technical leadership in system implementation.</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Leslie_Lamport">Leslie Lamport</a></td>
<td>For fundamental contributions to the theory and practice of distributed and concurrent systems, notably the invention of concepts such as causality and logical clocks, safety and liveness, replicated state machines, and sequential consistency.</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Michael_Stonebraker">Michael Stonebraker</a></td>
<td>For fundamental contributions to the concepts and practices underlying modern database systems.</td>
</tr>
</tbody>
</table>
<h3 id="misc">misc</h3>
<ol>
<li>新的协议和正确性问题(面向新的场景和需求，提出新的协议)</li>
<li>OCC</li>
<li>MVCC</li>
<li>确定的事务调度</li>
<li>Distributed Snapshot Isolation</li>
<li>传统技术：Plan Cache, Result Cache, BufferPool淘汰算法，etc.</li>
<li>多核：MVCC协议，锁表设计，bufferpool，日志提交算法，lock-free btree/hash</li>
<li>大内存：all in memory, Numa-Aware, Anti-caching, 压缩技术</li>
<li>SCM：write behind logging, 新的Checkpoint算法</li>
<li>性能稳定性: 在高并发，大负载下能够持续稳定的运行(垃圾回收，Buffer算法，持续Checkpoint)</li>
<li>TPCC性能指标：Hyper-DB : 单机20核15万TPS，NAM-DB：16核 56节点，650万new-order tps</li>
<li>高可用问题(单点、DC、城市级高可用，5-6个9)</li>
<li>共享缓冲区的集群架构：大机，PureScale, Oracle RAC</li>
<li>云分布式架构: Aurora，Spanner</li>
</ol>
<h2 id="_8">关注</h2>
<ul>
<li><a href="https://db.cs.cmu.edu/courses/">CMU数据库课程</a></li>
<li><a href="https://www.cs.columbia.edu/~du/ds/schedule.html">哥伦比亚大学分布式</a></li>
<li><a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-830-database-systems-fall-2010/lecture-notes/">MIT数据库课程</a></li>
<li><a href="http://daslab.seas.harvard.edu/classes/cs165/">哈佛数据库课程</a></li>
<li><a href="http://zoo.cs.yale.edu/classes/cs637/index.html">耶鲁大学数据库课程</a></li>
<li><a href="http://db.csail.mit.edu/">MIT Database Group</a></li>
<li><a href="http://mysql.taobao.org/monthly/">数据库内核月报</a></li>
<li><a href="http://www.cs.cmu.edu/~pavlo/">CMU数据库大牛</a></li>
<li><a href="http://www.bailis.org/">Peter Bailis Highly Available, Seldom Consistent</a></li>
<li><a href="http://dbmsmusings.blogspot.com/">DBMS musings</a> </li>
<li><a href="http://cs.yale.edu/homes/thomson/">Alexander Thomson calvin研究人员</a> </li>
<li><a href="https://hyeontaek.com/">Hyeontaek Lim CMU PhD</a></li>
<li><a href="https://www.allthingsdistributed.com">AWS CTO blog</a></li>
<li><a href="http://db.csail.mit.edu/madden/">教授Samuel Madden</a></li>
<li><a href="https://cs.uwaterloo.ca/~tozsu/">分布式数据库系统原理作者</a></li>
<li><a href="http://www.cs.umd.edu/~abadi/">Daniel Abadi Calvin DB 作者</a></li>
<li><a href="https://www.csail.mit.edu/user/1547">Michael Stonebraker</a></li>
<li><a href="https://sigmod.org/sigmod-awards/people/goetz-graefe-2017-sigmod-edgar-f-codd-innovations-award/">Goetz Graefe — 2017 SIGMOD Edgar F. Codd Innovations Award</a></li>
<li><a href="https://scholar.google.com/citations?hl=en&amp;user=pdDeRScAAAAJ">Goetz Graefe papers</a></li>
</ul>
<h2 id="_9">书籍</h2>
<ul>
<li><a href="http://www.brendangregg.com/systems-performance-2nd-edition-book.html">http://www.brendangregg.com/systems-performance-2nd-edition-book.html</a></li>
<li><a href="https://book.douban.com/subject/4838430/">数据库系统实现</a></li>
<li><a href="http://shop.oreilly.com/product/0636920032175.do">Designing Data-Intensive Applications</a></li>
<li><a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.219.7269&amp;rep=rep1&amp;type=pdf">Modern B-Tree Techniques</a></li>
<li><a href="http://www.redbook.io/">Readings in Database Systems, 5<sup>th</sup> Edition</a> 2015 介绍数据库领域主要内容和方向</li>
<li><a href="http://dblab.xmu.edu.cn/post/architecture-of-a-database-system/">Architecture of a Database System（中文版）</a></li>
<li><a href="http://book.mixu.net/distsys/">Distributed systems for fun and profit</a></li>
<li>Streaming Systems The What, Where, When, and How of Large-Scale Data Processing - Tyler Akidau.pdf</li>
<li>An Architecture for Fast and General Data Processing on Large Clusters.pdf</li>
<li>Consensus on Transaction Commit.pdf</li>
<li>database_system_concepts_en_6th.pdf</li>
<li>Distributed.Systems.An.Algorithmic.Approach.2<sup>nd</sup>.Edition.pdf</li>
<li>Making Databases Work.pdf</li>
<li>postgresql_introduction_and_concepts.pdf</li>
<li>Postgres-XC Concept, Implementation and Achievements.pdf</li>
<li>Architecture of a Database System (2007)</li>
<li>Readings in Database Systems, 5<sup>th</sup> Edition</li>
<li><a href="https://book.douban.com/subject/1788421/">UNIX环境高级编程</a></li>
<li>UNIX网络编程</li>
<li>PostgreSQL数据库内核分析</li>
<li>MySQL内核：InnoDB存储引擎</li>
<li><a href="https://www.tutorialspoint.com/sqlite/">SQLite Tutorial</a></li>
<li><a href="https://learntla.com/book/">Learn TLA+</a></li>
<li>面对软件错误构建可靠的分布式系统 Joe Armstrong Erlang作者博士论文</li>
</ul>
<h2 id="_10">文章</h2>
<h3 id="_11">分布式</h3>
<p><a href="https://draveness.me/etcd-introduction">高可用分布式存储 etcd 的实现原理</a>
<a href="https://mp.weixin.qq.com/s?__biz=MzI4NDMyNTU2Mw==&amp;mid=2247483695&amp;idx=1&amp;sn=91ea422913fc62579e020e941d1d059e#rd">微信自研生产级paxos类库PhxPaxos实现原理介绍</a> 比较详细的原理介绍</p>
<p>2010 Scalability patterns Scalability, Availability &amp; Stability (slides).pdf</p>
<h3 id="newsql">NewSQL</h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Spanner: Google’s Globally Distributed Database</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://cloud.google.com/spanner/docs/true-time-external-consistency?hl=zh-CN">https://cloud.google.com/spanner/docs/true-time-external-consistency?hl=zh-CN</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://static.googleusercontent.com/media/research.google.com/zh-CN//pubs/archive/45855.pdf">cloud spanner 技术白皮书</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://news.ycombinator.com/item?id=18039489">NewSQL databases fail to guarantee consistency and I blame Spanner</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/docs/stable/strong-consistency.html">https://www.cockroachlabs.com/docs/stable/strong-consistency.html</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/docs/stable/distributed-transactions.html">https://www.cockroachlabs.com/docs/stable/distributed-transactions.html</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/serializable-lockless-distributed-isolation-cockroachdb/">https://www.cockroachlabs.com/blog/serializable-lockless-distributed-isolation-cockroachdb/</a>  Serializable, Lockless, Distributed: Isolation in CockroachDB</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/acid-rain/">https://www.cockroachlabs.com/blog/acid-rain/</a>  Real Transactions are Serializable</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/consistency-model/">https://www.cockroachlabs.com/blog/consistency-model/</a> CockroachDB's Consistency Model</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/living-without-atomic-clocks/">https://www.cockroachlabs.com/blog/living-without-atomic-clocks/</a> </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/how-cockroachdb-distributes-atomic-transactions/">https://www.cockroachlabs.com/blog/how-cockroachdb-distributes-atomic-transactions/</a>  How CockroachDB Does Distributed, Atomic Transactions</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Consensus, Made Thrive</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Trust, But Verify: How CockroachDB Checks Replication</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> The CockroachDB Architecture Document</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/local-and-distributed-processing-in-cockroachdb/">https://www.cockroachlabs.com/blog/local-and-distributed-processing-in-cockroachdb/</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/memory-usage-cockroachdb/">https://www.cockroachlabs.com/blog/memory-usage-cockroachdb/</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cockroachlabs.com/blog/limits-of-the-cap-theorem/">https://www.cockroachlabs.com/blog/limits-of-the-cap-theorem/</a></li>
</ul>
<h3 id="_12">其它</h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://en.wikipedia.org/wiki/Consistency_model">维基百科 Consistency model</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://iswade.github.io/translate/strong_consistency_models/">强一致性模型</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.jianshu.com/p/8500882ab38c">siddontang分布式系统中的时间</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="http://www.nosqlnotes.com/technotes/mvcc-snapshot-isolation/">mvcc-snapshot-isolation</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.jianshu.com/nb/4437">siddontang一致性模型</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.jianshu.com/p/f307bd2023f5">Spanner: CAP, TrueTime and Transaction</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="http://daslab.seas.harvard.edu/rum-conjecture/">Read update memory 推测</a></li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://github.com/wiredtiger/wiredtiger/wiki/Btree-vs-LSM">Btree vs LSM performance</a></p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="http://docs.aws.amazon.com/zh_cn/redshift/latest/dg/welcome.html">Redshift 介绍</a></p>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://zhuanlan.zhihu.com/p/23866692">NewSQL系统综述——NewSQL到底New在哪里？</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://mp.weixin.qq.com/s?__biz=MzI4MjE3MTcwNA==&amp;mid=2664334610&amp;idx=1&amp;sn=9c09ba95f0f2dae6b83d8e521054fae9">开源数据库的现状</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://pingcap.com/blog-cloud-native-db-zh">云时代数据库的核心特点</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://postgres-x2.github.io/reference/1.2/html/index.html">Postgres-XC 1.2.1 Documentation</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://postgres-x2.github.io/presentation_docs/2015-07-25_HangZhou/PGXC_Scaleout_Approach.pdf">PGXL</a> 主要介绍XL，同时介绍XC-XL的区别</li>
</ul>
<h2 id="_13">论文</h2>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Reliability Analytics for Cloud Based Distributed Databases</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> FoundationDB Record Layer: A Multi-Tenant Structured Datastore 2019sigmod</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://www.vldb.org/pvldb/vldb2010/papers/R106.pdf">Tree Indexing on Solid State Drives</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://pages.cs.wisc.edu/~yinan/paper/fdtree_pvldb.pdf">Tree Indexing on Solid State Drives</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://15721.courses.cs.cmu.edu/spring2017/papers/08-oltpindexes2/bwtree-icde2013.pdf">The Bw-Tree: A B-tree for New Hardware Platforms</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://hyeontaek.com/papers/openbwtree-sigmod2018.pdf">Building a Bw-Tree Takes More Than Just Buzz Words</a> 2018sigmod</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://github.com/wangziqi2013/BwTree">peloton Bw-Tree implementation</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://paulcavallaro.com/blog/the-bw-tree/">The Bw-Tree</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://news.ycombinator.com/item?id=15409757">Modern B-Tree Techniques (2011) </a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://www.vldb.org/pvldb/vol8/p1668-shukla.pdf">Schema-Agnostic Indexing with Azure DocumentDB</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://www.microsoft.com/en-us/research/uploads/prod/2019/02/autoindexing_azuredb.pdf">Automatically Indexing Millions of Databases in Microsoft Azure SQL Database</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> A critique of ANSI SQL isolation levels 1110引用</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Concurrency control and recovery in database systems 6000引用 book</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Serializable Isolation for Snapshot Databases. 213引用 博士论文 2009.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Making snapshot isolation serializable 330引用</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Serializable snapshot isolation in PostgreSQL 89引用</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> The End of an Architectural Era 744引用 </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://www.sigops.org/s/conferences/sosp/2011/current/2011-Cascais/printable/11-calder.pdf">Windows Azure Storage: a highly available cloud storage service with strong consistency</a> 679次引用</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://www.vldb.org/pvldb/vol8/p185-bailis.pdf">Coordination Avoidance in Database Systems</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://db.cs.berkeley.edu/jmh/papers/anna_ieee18.pdf">Anna: A KVS For Any Scale</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://juejin.im/post/5aaa5495518825557b4c7966">伯克利推出世界最快的KVS数据库Anna：秒杀Redis和Cassandra</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://www.microsoft.com/en-us/research/publication/the-bw-tree-a-b-tree-for-new-hardware/">The Bw-Tree: A B-tree for New Hardware Platforms</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> A Survey of B-Tree Locking Techniques</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://en.wikipedia.org/wiki/Snapshot_isolation">快照隔离 wiki</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Distributed Snapshot Isolation Global Transactions Pay Globally, Local Transactions Pay Locally</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Efficient Optimistic Concurrency Control Using Loosely Synchronized Clocks</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Clock-SI: Snapshot Isolation for Partitioned Data Stores Using Loosely Synchronized Clocks 完全去中心化的一个协议， 无需中心时间服务器，直接通过本地时间加等待的方式实现快照隔离。使用2pc做原子提交。重点关注一下，是否可以使用到当前系统中？</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.pgcon.org/2018/schedule/attachments/498_Towards%20scalable%20ACID%20PostgreSQL%20with%20pg_shardman">Towards ACID scalable PostgreSQL with partitioning and logical replication</a> 有一点clock-SI的介绍。</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://www.bailis.org/papers/ramp-sigmod2014.pdf">Scalable Atomic Visibility with RAMP Transactions</a> 原子可见性</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://pages.cs.wisc.edu/~yinan/paper/fdtree_pvldb.pdf">Tree Indexing on Solid State Drives</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="http://s4lab.ustc.edu.cn/_upload/article/files/d3/dd/8de86d2c4056b9ebbf07507414f2/91bd85b9-2a80-432d-aec9-a44b73d5d059.pptx">LSbM-tree:一个读写兼优的大数据存储结构</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="http://www.csc.lsu.edu/~fchen/publications/papers/icdcs17-lsbm.pdf">LSbM-tree: Re-enabling Buffer Caching in Data Management for Mixed Reads and Writes</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://www.cs.cornell.edu/projects/ladis2009/papers/lakshman-ladis2009.pdf">Cassandra - A Decentralized Structured Storage System</a> 2000 被引用</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> ARIES: A Transaction Recovery Method Supporting Fine-Granularity Locking and Partial Rollbacks Using Write-Ahead Logging (1992) 事务-恢复</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Hybrid Transactional/Analytical Processing: A Survey</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Calvin: Fast Distributed Transactions for Partitioned Database Systems</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Distributed Architecture of Oracle Database In-memory </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Query Optimization in Oracle 12c Database In-Memory</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Cost-based query transformation in Oracle 2006</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Linearizability: a correctness condition for concurrent objects</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Benchmarking cloud serving systems with YCSB</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> SQL查询的语义验证 A Formal Semantics of SQL Queries, Its Validation, and Applications</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> 微软自动建立百万数据库索引 Automatically Indexing Millions of Databases in Microsoft Azure SQL Database</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> FDB的记录层 FoundationDB Record Layer: A Multi-Tenant Structured Datastore</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> 直接记录SQL语句作为SQLite的日志 SQL Statement Logging for Making SQLite Truly Lite</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Highly Available Transactions: Virtues and Limitations</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Revisiting Memory Errors in Large-Scale Production Data Centers: Analysis and Modeling of New Trends from the Field.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Failure Trends in a Large Disk Drive Population.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> A Large-Scale Study of Flash Memory Failures in the Field.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Failure Analysis of Virtual and Physical Machines:Patterns, Causes and Characteristics</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://www.cs.duke.edu/courses/cps296.4/fall13/838-CloudPapers/dean_longtail.pdf">www.cs.duke.edu/courses/cps296.4/fall13/838-CloudPapers/dean_longtail.pdf</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://arxiv.org/pdf/1701.03100.pdf">https://arxiv.org/pdf/1701.03100.pdf</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Datacenter Scale Evaluation of the Impact of Temperature on Hard Disk Drive Failures</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://blog.fosketts.net/2011/07/06/defining-failure-mttr-mttf-mtbf/">http://blog.fosketts.net/2011/07/06/defining-failure-mttr-mttf-mtbf/</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Understanding Network Failures in Data Centers: Measurement, Analysis, and Implications</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://cs.unc.edu/xcms/wpfiles/50th-symp/Moorthy.pdf">http://cs.unc.edu/xcms/wpfiles/50th-symp/Moorthy.pdf</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://cs-www.cs.yale.edu/homes/dna/papers/abadi-pacelc.pdf">http://cs-www.cs.yale.edu/homes/dna/papers/abadi-pacelc.pdf</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://www.bailis.org/papers/hat-vldb2014.pdf">http://www.bailis.org/papers/hat-vldb2014.pdf</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Lessons learnt from building a globally distributed database from the ground up</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Logical Physical Clocks and Consistent Snapshots in Globally Distributed Databases</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> I/O Reference Behavior of Production Database Workloads and the TPC Benchmarks - An Analysis at the Logical Level</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> The End of Slow Networks: It's Time for a Redesign</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> The CAT Theorem and Performance of Transactional Distributed Systems</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Deuteronomy: Transaction Support for Cloud Data.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Transactions: From Local Atomicity to Atomicity in the Cloud</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spanner's SQL Evolution， Data@Scale 2017, Seattle</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://www.percona.com/blog/2016/07/26/testing-samsung-storage-in-tpcc-mysql-benchmark-percona-server/">www.percona.com/blog/2016/07/26/testing-samsung-storage-in-tpcc-mysql-benchmark-percona-server/</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="https://www.nextplatform.com/2017/08/15/hardware-drives-shape-databases-come/">https://www.nextplatform.com/2017/08/15/hardware-drives-shape-databases-come/</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> How disruptive is Modern Hardware?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <a href="http://www.jos.org.cn/jos/ch/reader/view_abstract.aspx?flag=1&amp;file_no=4416&amp;journal_id=jos">支持大数据管理的NoSQL系统研究综述</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> 1997 <a href="http://www.cs.sfu.ca/CourseCentral/459/han/papers/chaudhuri97.pdf">An overview of data warehousing and OLAP technology</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> 2016 ☆ <a href="http://ieeexplore.ieee.org/abstract/document/7751638/">A unified OLAP/OLTP big data processing framework in telecom industry</a> </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Towards a Non-2PC Transaction Management in Distributed Database Systems，介绍如何消除2PC事务，相关博客文章http://dbmsmusings.blogspot.com/2019/01/its-time-to-move-on-from-two-phase.html</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 2007 <a href="http://dblab.xmu.edu.cn/post/architecture-of-a-database-system/">Architecture of a Database System</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 2011 <a href="http://www.thebigdata.cn/upload/2014-08/14080113469511.pdf">架构大数据: 挑战, 现状与展望</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://www.cs.utexas.edu/users/misra/scannedPdf.dir/DistrDeadlockDetection.pdf">Distributed Deadlock Detection</a> 分布式死锁检测</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="http://www.jos.org.cn/1000-9825/5644.htm">大数据管理系统的历史、现状与未来</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 大数据管理：概念、技术与挑战 1000+引用</li>
</ul>
<h2 id="_14">实例汇总</h2>
<h3 id="taurusdb">TaurusDB</h3>
<p>Taurus Database: How to be Fast, Available, and Frugal in the Cloud
<a href="https://dl.acm.org/doi/pdf/10.1145/3318464.3386129">https://dl.acm.org/doi/pdf/10.1145/3318464.3386129</a></p>
<h3 id="snowflake">Snowflake</h3>
<p>The Snowflake Data Warehouse 分析其原理和架构</p>
<h3 id="cockroachdb">CockroachDB</h3>
<p><a href="https://dl.acm.org/doi/pdf/10.1145/3318464.3386134">CockroachDB: The Resilient Geo-Distributed SQL Database</a></p>
<h4 id="cockroachdb_1">迁移到CockroachDB</h4>
<ol>
<li>总体感到满意</li>
<li>兼容性：使用PG协议</li>
<li>备份：仅能使用全量备份，付费的增量备份与PG相比也较弱，有HA能力，但是备份是灾备的基本能力</li>
<li>安全连接：insecure、TLS加密，没有用户密码能力</li>
<li>部分索引：没有，例如 CREATE INDEX foo ON t1(c1) WHERE c2 &gt; 1;</li>
<li>数据类型：range数据类型，枚举</li>
<li>触发器：不支持</li>
<li>自定义函数：不支持</li>
<li>存储过程：不支持</li>
<li>冲突处理：on conflict do nothing，不支持</li>
<li>外键：不能推迟外键检查</li>
<li>全文检索：没有全文搜索，也没有地理空间功能。</li>
<li>UPSERT：无法检查是插入还是更新</li>
<li>CLI：功能很基础</li>
<li>扩展：单PG到3节点，性能差了，需要几毫秒延迟（可用性代价）</li>
<li>复杂查询：需要进行性能测试</li>
<li>监视：监视诊断工具较少</li>
<li>遥测功能：默认情况下处于启用状态。可以通过将 <code>COCKROACH_SKIP_ENABLING_DIAGNOSTIC_REPORTING</code> 环境变量设置为true来禁用它。</li>
<li>最后，迁移过程几乎没有痛苦。每个限制和差异都可以很快解决。未参与迁移的开发人员几乎可以继续进行开发，好像没有什么改变一样（他们一次又一次地遇到局限性，例如没有部分索引，并问“蟑螂不支持...。”）。CockroachDB有一个有用的页面，该页面记录了他们的工作和不支持的工作以及更详细的列表。如果您正在考虑使用它，那是一个很好的开始。尽管如此，基本原理还是有很大的不同，您需要花一些时间在他们的网站上以熟悉底层的体系结构和实现。值得庆幸的是，它们的<strong>内容详尽</strong>，写得很好并且组织得很好。我们<strong>没有使用很多CockrorachDB功能</strong>，例如分区表，内容本地性，复制区域，更改数据捕获等。相反，有许多我们没有使用的PostgreSQL功能，可能很难迁移掉。我确实担心我们最终会遇到一个复杂的要求，即PG（或其众多扩展之一）可以帮助我们解决。但是，对于PostgreSQL，我更加担心如何检测故障并将<strong>故障转移</strong>到备用状态。</li>
<li>我忘了提到一些重要的事情。迁移的系统具有<strong>可靠的测试</strong>和良好的覆盖范围。尽管我们遇到的许多差异是显而易见的（例如缺少范围类型和触发器），但其他差异则更为微妙（尤其是冲突行为方面的奇怪之处）。<strong>测试覆盖率</strong>对迁移速度和我们对推广的信心产生了重大影响。</li>
</ol>
<h3 id="_15">阿里巴巴</h3>
<p>阿里云的PolarDB组: PolarDB
阿里巴巴集团的数据库部门: X-DB(Polar-X)/X-Engine/X-Paxos
X-Engine类似于MySQL on RocksDB MyRocks，基于LSM-Tree做了大量优化。
蚂蚁金服：OceanBase</p>
<h4 id="oceanbase">OceanBase</h4>
<p>OceanBase 一致性：
<strong>单机</strong></p>
<ul>
<li>如何同时读写同一条数据？经典模式：通过锁来互斥，实现隔离级别</li>
<li>快照隔离和 MVCC：并发读写问题。与加锁的方式实现还是不一样的，但是对用户来说行为是一样的，对数据库的隔离性几乎没有影响</li>
</ul>
<p><strong>分布式架构面临的挑战</strong></p>
<ul>
<li>多机协同工作带来的新问题</li>
</ul>
<p>OceanBase 性能优化：</p>
<ul>
<li>OceanBase存储引擎，类似 LSM-Tree</li>
<li>性能目标：延迟和吞吐量，两个指标的关系？吞吐量与延迟定量分析</li>
<li>性能优化工作：优化语句执行消耗的指令数，优化执行指令的效率</li>
<li>系统的性能是每一行代码决定的：两阶段提交重构，Commit 异步化，列类型转换下压，事务状态机转换函数优化，SQL Trace ID 存储与序列化优化，分区裁剪分区选择优化，迭代器初始化优化，内存分配器优化，资源 Free List 优化，线程局部存储优化，Plan Cache 选择优化，Schema 缓存优化</li>
<li>两阶段提交优化：结合事务与日志，事务 Prepare 成功后内侧不用持久保存状态，按需从日志中查询，commit 状态持久化转换成后台批量完成</li>
<li>Commit 异步化：上下文切换开销问题，异步化后work er 不等待继续执行队列中的下一个请求，日志持久化后会异步回调</li>
<li>扩展性问题：64 核CPU 是否可以扩展？64 线程加锁解锁方式同时做计数器+1（16328），原子操作`__sync_and_and_fetch*，仅1 个线程做+1（349162011）</li>
<li>内存分配器优化</li>
<li>性能优化无止境</li>
</ul>
<p>参考：<a href="http://www.itdks.com/Course/detail?id=16895">http://www.itdks.com/Course/detail?id=16895</a></p>
<h4 id="x-paxos">X-Paxos: 复制库</h4>
<ol>
<li>工业级，独立，基础库</li>
<li>Google，Facebook没有公开过</li>
<li>Zookeeper，不支持高吞吐，没有独立的第三方库</li>
<li>phxpaxos</li>
<li>网络层：基于阿里内部的 libeasy 实现，异步框架，线程池，重连</li>
<li>服务层：事件驱动，定时毁掉，C++11多线程异步框架</li>
<li>算法模块：unique proposer 的 multi-paxos</li>
<li>日志模块：独立的日志模块</li>
<li>在线增删节点，在线转让 leader</li>
<li>策略化多数派和权重化选主</li>
<li>节点角色定制化（Proposer/Accepter/Learner 独立配置）</li>
<li>witness SDK，learner 角色，数据订阅者，订阅注册，流式订阅</li>
<li>我们一直坚信网络延迟不应该影响吞吐</li>
<li>batching &amp; pipelining，吞吐、延迟</li>
<li>多线程：所有任务使用通用的worker来运行，消除CPU瓶颈，除了必要的协议串行化点外，部分协议串行点采用无锁设计</li>
<li>基于位置的内容分发：多 region 时，网络效率使用，感知网络延迟，拓扑重组规则</li>
<li>可插拔日志：WAL 和 paxos 日志，改造 binlog 模块，仅保存一份日志</li>
<li>正确性验证：Jepsen，TLA+，随机异常系统（自动化验证X-Paxos在模拟网络丢包、闪断、隔离，磁盘故障等情况下的功能正确和数据一致。），异常回归系统</li>
<li>跨Region场景下phxpaxos几乎不可用，而X-Paxos在444Byte（sysbench insert场景单请求大小），性能只有3.5%的下降，几乎不影响吞吐。</li>
<li>未来：高效率，多分区支持，多节点强一致性读</li>
</ol>
<p>参考：</p>
<ul>
<li><a href="http://hedengcheng.com/?p=985">http://hedengcheng.com/?p=985</a></li>
<li>X-Cluster: 基于X-Paxos的三节点MySQL，与Group Replication类似 </li>
<li><a href="https://yq.aliyun.com/articles/165138">https://yq.aliyun.com/articles/165138</a></li>
<li><a href="https://mp.weixin.qq.com/s/EN09RG8c695iDm0edoM5mg">X-Paxos — 阿里巴巴的高性能分布式强一致Paxos独立基础库</a></li>
</ul>
<h3 id="mysql">MySQL</h3>
<h4 id="mysql-group-replication">MySQL Group Replication</h4>
<p><a href="https://dev.mysql.com/doc/refman/5.7/en/group-replication.html">MySQL GR</a>
<a href="https://dev.mysql.com/doc/refman/5.7/en/group-replication-flow-control.html">MySQL GR 流控</a>，收集所有服务的监控指标，然后决定是否进行流控。（队列大小等信息）</p>
<p>延迟控制机制
异步复制，半同步复制，都是允许从库是有延迟的。组复制也允许有延迟，但是将延迟的控制做的更加细腻。引入了Flow Control机制，flow control的设计目标：
1. 尽量保持节点间在同一时刻的一致性
2. 能够快速的在不同情况下做出改变
3. 平衡每一个节点的写入能力
4. 不可以限流过度，导致不必要的资源浪费</p>
<p>MySQL8.0 MGR功能改进
1. 支持设置节点权重，且权重最大的在线节点将被选举为主
2. 每个节点中存储更多的状态信息，如版本、角色等
3. 可根据从节点的事务状态，自动化流控
4. 离开集群的服务器自动被设置为read only，避免被误操作更新数据
5. 可监控MGR的内存使用情况</p>
<h3 id="tikv">TiKV</h3>
<h4 id="1">1. 介绍</h4>
<p>在2015年中期，我们决定建立一个解决MySQL扩展问题的数据库。那时，增加MySQL可伸缩性的最常见方法是在MySQL之上构建一个代理，以更有效地分配负载，但我们认为这不是最好的方法。据我们所知，基于代理的解决方案存在以下问题：</p>
<ul>
<li>在MySQL服务器之上构建代理不能保证ACID合规性。值得注意的是，不支持原生跨节点事务。</li>
<li>它对业务灵活性提出了巨大挑战，因为用户必须担心数据分发并仔细设计其分片键以避免低效查询。</li>
<li>基于传统的主从复制，无法轻松保证MySQL的高可用性和数据一致性。</li>
</ul>
<p>虽然在开始时直接构建基于MySQL的代理可能很容易，但我们仍然决定选择另一种方式，一种更难的方法 - 从头开始构建分布式，MySQL兼容的数据库。</p>
<p>幸运的是，Google遇到了同样的问题，并且已经发表了一些文章来描述他们如何构建Spanner和F1来解决它。Spanner是一个全局分布的，外部一致的数据库，F1是一个基于Spanner的分布式SQL数据库。受Spanner和F1的启发，我们知道我们可以做同样的事情。所以我们开始构建TiDB--像F1这样的无状态MySQL层。在我们发布TiDB之后，我们知道我们需要一个基础类似Spanner的数据库，所以我们开始开发TiKV。</p>
<p>RocksDB
Raft
MVCC
分布式事务
计算下推到存储
gRPC
PD</p>
<h4 id="2">2. 共识算法</h4>
<p>Failure Raft Paxos Chubby etcd</p>
<p>CAP理论
- 一致性：每次读取都会收到最近的写入或错误（线性一致性）
- 可用性：每个请求都会收到（非错误）响应 - 不必考虑最近的写入
- 分区：尽管节点之间丢弃（或延迟）任意数量的消息，系统仍继续运行</p>
<p>BASE  PACELC</p>
<p>拜占庭错误：
- 积极传播不正确的信息
- 故意不传播正确的信息
- 修改本来是正确的信息</p>
<h4 id="3-kv">3. KV引擎</h4>
<p>写放大: B-tree  &gt; LSM
读放大：B-tree  &lt; LSM</p>
<p>通过比较B +树和基于Level的LSM树之间的各种放大，我们可以得出结论，基于Level的LSM树具有比B+树更好的写性能，而其读取性能不如B+树。TiKV使用LSM树而不是B树作为其底层存储引擎的主要目的是<strong>因为使用缓存技术来提升读取性能比提升写入性能要容易得</strong>多。</p>
<p>RocksDB: 
Get/Put/Delete/Iterate
前缀布隆过滤器等高级特性</p>
<h4 id="4">4. 分布式事务</h4>
<p>TiKV采用谷歌的Percolator交易模式，是2PC的变种。</p>
<p>隔离级别：SI
SELECT ... FOR UPDATE，写偏问题，在这种情况下，TiDB将使用锁定与MVCC一起序列化写入以获得一些性能增益，并仍然支持更强的“可串行化”隔离级别。</p>
<p>分布式算法：2PC/3PC/Paxos提交</p>
<p>锁定：悲观锁，乐观锁，Percolator事务模型（乐观锁）</p>
<p>时间戳服务器：时间戳oracle在Percolator事务模型中起着重要作用，它是一个服务器，它以严格递增的顺序发出时间戳，这是正确操作快照隔离协议所需的属性。  Spanner原子钟、HLC</p>
<p>BigTable支持单行事务。
Percolator实现了分布式事务，SI隔离级别语义。
优化：并行预写，不使用时间戳的点读，计算提交时间戳，单region1PC</p>
<h4 id="5">5. 伸缩性</h4>
<p>水平伸缩，垂直伸缩
分区：哈希分区，范围分区
Multi-Raft: Region分裂，合并</p>
<h3 id="microsoft">Microsoft</h3>
<ul>
<li>FASTER: A Concurrent Key-Value Store with In-Place Updates</li>
<li>Hekaton: SQL server's memory-optimized OLTP engine</li>
<li>CosmosDB</li>
<li><a href="https://azure.microsoft.com/zh-cn/blog/a-technical-overview-of-azure-cosmos-db/">https://azure.microsoft.com/zh-cn/blog/a-technical-overview-of-azure-cosmos-db/</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/cosmos-db/consistency-levels">https://docs.microsoft.com/en-us/azure/cosmos-db/consistency-levels</a></li>
<li><a href="https://www.snia.org/sites/default/files/SDC15_presentations/database/SudiptaSengupta_Bw-Tree-Key_Value.pdf">https://www.snia.org/sites/default/files/SDC15_presentations/database/SudiptaSengupta_Bw-Tree-Key_Value.pdf</a></li>
<li><a href="https://docs.microsoft.com/zh-cn/azure/cosmos-db/">https://docs.microsoft.com/zh-cn/azure/cosmos-db/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Cosmos_DB">https://en.wikipedia.org/wiki/Cosmos_DB</a></li>
</ul>
<h4 id="the-new-sql-server-in-the-cloud">The New SQL Server in the Cloud</h4>
<p><a href="https://www.microsoft.com/en-us/research/uploads/prod/2019/05/socrates.pdf">Socrates: The New SQL Server in the Cloud</a></p>
<h5 id="1_1">1. 介绍</h5>
<p>高安全、高额可用、低成本、灵活性、高性能。上市时间、按需付费、99.999%可用性、大规模数据（100TB）、高性能、弹性。</p>
<ol>
<li>传统数据库提前部署的方式，无法弹性、按需付费：为了满足高吞吐或者低吞吐，需要将一个很大的数据库从一个机器移动到另一个机器，但是代价会非常高。</li>
<li>另一个更微妙的问题是支持大型事务数据库的目标与高可用性之间存在冲突：高可用性需要很小的平均恢复时间（MTTR），传统上只能通过小型数据库实现。这个问题在传统数据库上不会出现，因为不熟采用了典型的昂贵的硬件来满足高可用（例如存储区域网络或SAN），这种硬件在云上不可用，传统数据库通过控制软件更新周期以及非常小心的计划停机来实现高可用，这种方式在云上都是不可行的。</li>
</ol>
<p>过去10年都在研究云上新OLTP数据库系统架构。一个想法是解耦DBMS的功能单元，独立地部署计算服务（例如事务处理）和存储服务（例如检查点和恢复）。Socrates也采用了这种架构，并且将数据库日志从存储中分离出来，作为第一类对象对待，分离日志的方式也将持久性和可用性分割开来。</p>
<h5 id="2_1">2. 现有技术</h5>
<ol>
<li>SQL Server：HADR， Socrates</li>
<li>Spanner：分区splits</li>
<li>Aurora：共享磁盘，数据和日志分区</li>
<li>Oracle：基于 Exadata 和 RAC</li>
</ol>
<h3 id="anna">Anna</h3>
<p>格 lattice</p>
<p>交换性：$t（a，b）= t（b，a）∀a，b∈S $</p>
<p>相关性：<span><span class="MathJax_Preview">t（t（a，b），c）= t（a，t（b，c））∀a，b，c∈S</span><script type="math/tex">t（t（a，b），c）= t（a，t（b，c））∀a，b，c∈S</script></span></p>
<p>幂等性：<span><span class="MathJax_Preview">t（a，a）=a∀a∈S</span><script type="math/tex">t（a，a）=a∀a∈S</script></span></p>
<p>复制 hot keys 可以提升性能</p>
<p>使用格来实现异步merge</p>
<p>可配置的一致性：读已提交，未提交，last-writer-win</p>
<ul>
<li><a href="https://github.com/fluent-project/fluent">https://github.com/fluent-project/fluent</a></li>
<li><a href="http://www.redbook.io/">http://www.redbook.io/</a> Joe Hellerstein Anna</li>
<li><a href="https://rise.cs.berkeley.edu/">https://rise.cs.berkeley.edu/</a></li>
<li><a href="https://arxiv.org/pdf/1809.00089.pdf">https://arxiv.org/pdf/1809.00089.pdf</a></li>
<li><a href="http://db.cs.berkeley.edu/jmh/papers/anna_ieee18.pdf">http://db.cs.berkeley.edu/jmh/papers/anna_ieee18.pdf</a></li>
<li>Coordination Avoidance in Database Systems</li>
<li><a href="https://news.ycombinator.com/item?id=16551072">https://news.ycombinator.com/item?id=16551072</a></li>
</ul>
<h3 id="faunadb">FaunaDB</h3>
<p>基于 Calvin 的数据库，对于 spanner 衍生类系统和 Calvin 风格系统由很多讨论
Google Spanner vs. Calvin: Is There a Clear Winner in the Battle for Global Consistency at Scale?</p>
<h4 id="faunadb-an-architectural-overview">FaunaDB: An Architectural Overview</h4>
<ol>
<li><strong>起源</strong>：数据库管理系统的历史是一种日益增长的抽象。事务 NoSQL 数据库，伸缩，易用，生产力，ACID。</li>
<li><strong>基础</strong>：分布式数据操作系统。子系统：</li>
<li>NoSQL 查询语言</li>
<li>半结构化文档模型</li>
<li>分布式 ACID 事务引擎</li>
<li>行级访问控制系统 </li>
<li>基于策略的工作负载资源管理器(CPU/MEM/IO)</li>
<li>数据中心感知的路由层</li>
<li>临时存储系统(维护记录和索引的历史)。</li>
<li><strong>数据模型</strong>：半结构化，无模式对象关系数据模型，是关系，文档，面向对象和图形范例的严格超集。
   - 记录被插入到半结构化文档的实例中，可以包含递归嵌套对象和数组以及标量类型
   - 实例被分组为类，类似于关系数据库中的表，但是与文档数据库一样，类中的全部或者部分共享模式是可选的，不是强制的。
   - 类被组织成数据库。跟文件系统目录类似，数据库可以递归包含其它数据库。
   - 数据库访问由密钥控制。
   - 派生关系是使用索引构建的。索引是将一组输入实例转换为由术语和值组成的一个或多个结果集。 索引表示为部分应用的查询，可以转换，覆盖，排序其输入，并强制执行约束（在FaunaDB中，索引和视图是相同的）
   - 查询可以参数化为函数，类似于SQL系统中的存储过程，为了跨应用程序共享逻辑，从应用程序中抽象逻辑就地升级或者定制安全模型很困难。</li>
<li><strong>查询语言</strong></li>
<li><strong>安全性</strong></li>
<li><strong>可伸缩性</strong>：水平和垂直伸缩，自协调，无单点故障。集群中的每个节点同时执行下面的三种角色：查询协调器，数据副本，日志副本。
  - 路由：如果事务是只读的，则会立即给客户端应答；如果事务包含写操作，则会转发到合适的日志副本来处理事务决议。日志副本转发事务给涉及的数据副本，这些数据副本将最终解析事务并将应答返回给客户端连接的节点，然后该应答将返回给客户端。
  - 数据分区：在每个数据中心内部，逻辑数据布局被数据中心内的所有节点分区。实例，包含历史通过主键来分区。索引按term分区。无论实际情况和物理集群中的节点数量如何，实例和索引都会线性扩展以进行读取和写入。如果特定索引条目的读取或写入速度超过中值大小，则索引中的热点是可能的。 在这种情况下，FaunaDB可以跨多个范围对实例或索引条目进行分区，并在读取时执行部分离散-收集读取查询，类似于搜索系统。
  - 容错与 CAP：CP。容错：节点临时故障，节点永久故障，节点变慢，网络分区隔离了一个数据中心被隔离的数据中心可以继续读但是不能写。</li>
<li><strong>持久性</strong>：压缩的 LSM-tree，对磁盘和 SSD 都合适。</li>
<li><strong>事务一致性</strong>：严格的可序列化被广泛认为是理想的一致性模型。读写事务是严格可串行化的。只读事务是穿行化的。FaunaDB的主要权衡是写入延迟是发起数据中心与其他数据中心子集之间的往返延迟的下限。网络延迟严格地比最终一致的分布式键/值存储所暴露的延迟更严重，这些存储在确认提交之前不会尝试保证全局持久性，或者依赖于异步复制并且不能从副本提供一致读取的SQL系统。增加应用程序并行性可以补偿单个写入的延迟，而不会影响总体吞吐量。</li>
<li><strong>负载资源管理</strong>：QOS</li>
<li><strong>后台任务</strong>：诸如索引构建之类的后台任务是遗留数据库系统中可用性问题的常见来源。为了缓解这种情况，FaunaDB中的后台工作由一个记录的，拓扑感知的任务调度程序内部管理，类似于Apache Hadoop YARN。FaunaDB的实现是通用的。任务可以限于跨群集或每个数据库的一个实例，或者被分配特定数据范围（在这种情况下，执行节点将是该范围的数据副本）。每个任务的执行状态都保存在一致的元数据存储中，这意味着计划任务可以以节点无关的方式运行：如果节点出现故障或离开集群，其任务将自动重新分配给其他有效节点并重新启动或恢复。任务执行吞吐量由FaunaDB的资源调度程序控制。与任何租户无关的常规后台工作以低优先级运行，允许任务在空闲资源允许的情况下继续，并消除后台任务对同步请求的影响。</li>
<li><strong>运维</strong>：拓扑变更（增加、删除、替换节点；增加删除数据中心；变更复制配置），其它维护任务（使用逻辑和物理隔离备份、执行反熵检查、升级磁盘存储格式）</li>
<li><strong>应用场景</strong>：金融、电子商务、SaaS等。</li>
<li><strong>结论</strong>：本文概述了FaunaDB的设计和体系结构，FaunaDB是一个具有租户感知资源管理系统和灵活操作配置文件的事务性NoSQL数据库。FaunaDB是我们为现代企业的关键任务用例构建数据库的努力。 我们的工作基于数据库和操作系统方面的最新研究和行业进展，以及丰富的实践操作经验。虽然我们试图全面描述，我们遗漏了很多细节。我们期待着工作与开发人员社区，学术界以及当前和未来的客户共同实现现代操作数据库管理的共同愿景。</li>
</ol>
<h3 id="calvin">Calvin</h3>
<p>确定性数据库
- [ ] calvin数据库 根据siddontang的介绍，是确定性数据库，需要对事务排序
- [ ] <a href="https://www.jianshu.com/p/43909447728f">Calvin：一个为分区数据库设计的快速分布式事务框架</a>
- [ ] <a href="http://cs.yale.edu/homes/thomson/publications/calvin-sigmod12.pdf">Calvin: Fast Distributed Transactions for Partitioned Database Systems</a> 358引用
- [ ] <a href="http://cs.yale.edu/homes/thomson/publications/calvin-ieee13.pdf">http://cs.yale.edu/homes/thomson/publications/calvin-ieee13.pdf</a>
- [ ] <a href="http://www.vldb.org/pvldb/vol7/p821-ren.pdf">An Evaluation of the Advantages and Disadvantages of Deterministic Database Systems</a>
- <a href="https://fauna.com/blog/consistency-without-clocks-faunadb-transaction-protocol">https://fauna.com/blog/consistency-without-clocks-faunadb-transaction-protocol</a>
- <a href="https://www.tuicool.com/articles/AnYVjyY">https://www.tuicool.com/articles/AnYVjyY</a>
- <a href="https://fauna.com/blog/partitioned-consensus-and-its-impact-on-spanners-latency">https://fauna.com/blog/partitioned-consensus-and-its-impact-on-spanners-latency</a>
- The Case for Determinism in Database Systems appeared in VLDB 2010.
- Lightweight Locking for Main Memory Database Systems appeared in VLDB 2013.
- Modularity and Scalability in Calvin appeared in IEEE Data Engineering Bulletin in 2013.</p>
<p>摘要：最近关于确定性数据库系统设计的提议认为确定性数据库系统便于复制，因为相同的输入可以独立地发送到两个不同的副本而不用考虑副本分歧。此外，他们认为确定性会产生性能优势，这是由于（1）引入了死锁避免技术，（2）减少（或消除）分布式提交协议，以及（3）轻量级锁定。但是，这些性能优势并非普遍适用，并且确定性存在若干缺点，包括（1）处理事务的额外开销，事先不知道将访问哪些数据，（2）无法中止事务任意地（例如，在数据库或分区过载的情况下），以及（3）预处理层所需的增加的延迟，其确保将相同的输入发送到每个副本。本文提供了一个全面的实验研究，仔细研究了确定性的优缺点，以便让数据库用户更全面地了解用于给定数据库工作负载和群集配置的数据库。
结论：在本文中，我们提出了一个深入的研究，比较确定性和非确定性系统。</p>
<p>很明显，对于某些工作负载，确定性数据库系统是合适的，而对于某些工作负载则不是。对于对延迟敏感的应用程序，确定性系统中“预处理”事务所需的额外延迟可能会有问题，而非确定性系统可能更适合。此外，当没有其他方法来减少节点上的负载时，确定性数据库系统不能任意中止事务以处理节点过载也会限制吞吐量。但是，确定性数据库系统显然能够扩展到分布式事务的更高吞吐量，这主要是由于它们能够避免分布式死锁。因此，对于需要极高事务可伸缩性且不介意支付额外延迟成本的工作负载，确定性数据库系统可能非常适合。</p>
<h3 id="voltdb">VoltDB</h3>
<p>OLTP Through the Looking Glass, and What We Found There
HStore:A HighPerformance,Distributed Main MemoryTransaction Processing System</p>
<h3 id="aurora">Aurora</h3>
<p>Amazon Aurora: Design considerations for high throughput cloud-native relational databases 2017</p>
<p>Amazon Aurora: On Avoiding Distributed Consensus for I/Os, Commits, and Membership Changes 2018</p>
<p><a href="https://zhuanlan.zhihu.com/p/27872160">AWS Aurora论文观后</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/33603518">Amazon Aurora 深度探索</a></p>
<p><a href="http://www.yunweipai.com/archives/18411.html">AWS Aurora最强解读</a></p>
<h3 id="spanner">Spanner</h3>
<p>Spanner, TrueTime and the CAP Theorey</p>
<p>Spanner: Google's globally distributed database</p>
<p>Spanner:Becoming a SQL system</p>
<p>F1: A Distributed SQL Database That Scales</p>
<p>F1 Query: Declarative Querying at Scale</p>
<p><a href="https://www.infoq.cn/article/b*Kvqq0fydSl1x9yWmqm">Spanner 事务处理技术详解</a></p>
<p>每秒事务的吞吐量 = &frac12;ε = 1/0.008 = 125 个事务 / 秒</p>
<p>如果ε有希望减小，如缩小 200 倍，则一个 Spanner 集群的一个 Paxos 组也就是每秒两万五千个事务。这个值，其实不高。</p>
<p>另外，如果一个长事务总不提交，则后面的事务不能得到提交，解决办法是不支持过长事务，或者作为一个缺陷告诉用户只能使用短事务哦，否则发生问题概不负责之类的云云。</p>
<p>最后，我们要表明的是，如果<strong>不是写同一个数据项的并发事务</strong>（注意是并发不是并行哦），则<strong>吞吐量</strong>，是不应当这么计算的，不要因此处的讨论而引发不必要的争议。</p>
<p><a href="https://www.infoq.cn/article/b*Kvqq0fydSl1x9yWmqm">Spanner 事务处理技术详解</a>
<a href="https://cloud.google.com/spanner/docs/replication">spanner replication</a>
<a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2013/09/DC-col51-Sep13-1.pdf">Spanner's Concurrency Control</a> </p>
<p>spanner:
One subtle thing about Spanner is that it gets serializability from locks, but it gets external consistency(similar to linearizability) from TrueTime. 
这种“提交等待”等待时间不是很长，它与（内部）事务并行进行，所以通常不是很长。</p>
<h3 id="sql">SQL 数据库</h3>
<ul>
<li>Oracle, MySQL, SQL Server</li>
<li>EnterpriseDB, DB2, Greenplum, Teradata, </li>
<li>PostgreSQL</li>
</ul>
<h3 id="_16">分布式数据库</h3>
<ul>
<li>spanner</li>
<li>TIDB</li>
<li><a href="https://github.com/cockroachdb/cockroach">CockroachDB</a>: inspired by spanner with golang</li>
<li>OceanBase</li>
<li>pgxc: pg-xl, pgx2, pgxz</li>
<li><a href="http://mysql.taobao.org/monthly/2017/09/01/">PolarDB</a></li>
<li><a href="http://delivery.acm.org/10.1145/3060000/3056101/p1041-verbitski.pdf?ip=103.218.216.127&amp;id=3056101&amp;acc=OPENTOC&amp;key=4D4702B0C3E38B35%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35%2E9F04A3A78F7D3B8D&amp;CFID=993534440&amp;CFTOKEN=82234434&amp;__acm__=1507628397_0845ec0b8c3dfe760d260281e2ebb9ef">Aurora</a>: AWS paper</li>
<li>Oracle Sharding: 性能随 sharding 数线性增长(完美sharding)</li>
</ul>
<h3 id="_17">数据仓库</h3>
<ul>
<li>AWS redshift</li>
<li>阿里 HybridDB</li>
<li>微软 SQL server</li>
<li>Teredata</li>
<li>GreenplumDB</li>
</ul>
<h3 id="nosql">NoSQL</h3>
<ul>
<li>RocksDB</li>
<li>Redis</li>
<li>cassandra</li>
<li><a href="http://daslab.seas.harvard.edu/monkey/">Monkey</a>: LSMTree kv DB</li>
<li><a href="http://wiki.dreamrunner.org/public_html/C-C++/Library-Notes/LMDB.html">LMDB</a>: Light Memory Map DB</li>
<li><a href="https://www.progville.com/go/bolt-embedded-db-golang/">boltdb</a>: LMDB by Go</li>
<li>ManogoDB</li>
<li>LevelDB</li>
<li>LMDB</li>
<li>BoltDB</li>
<li>Dynamo</li>
<li>bigtable</li>
</ul>
<h3 id="_18">多模数据库</h3>
<h3 id="_19">未来技术方向</h3>
<ul>
<li>native分布式关系数据库</li>
<li>newSQL</li>
</ul>
<h4 id="newsql_1">NewSQL</h4>
<p>ACID
scale out
关系型</p>
<ol>
<li>基于内存的存储引擎</li>
<li>基于数据分区的水平扩展性</li>
<li>全局索引</li>
<li>基于MVCC的分布式事务</li>
<li>强一致的数据复制（多副本）</li>
<li>自动容灾高可用</li>
<li>同时支持OLTP和OLAP处理（行列混合存储，大规模并行处理能力）</li>
</ol>
<p>NewSQL既有NoSQL的特点，又有传统关系型数据库的特点。向数据发送查询，而不是将数据带给查询，更少的网络开销。对于MPP OLAP系统，还不能称之为NewSQL。</p>
<h2 id="_20">算法</h2>
<ul class="task-list">
<li>B+-tree</li>
<li>LSM-tree</li>
<li>Bloom Filter: 多列模糊等值匹配，不存在测试, lsm树中用于加快查找</li>
<li>HyperLogLog: 模糊 count(distinct ..) 计算</li>
<li>Bit-Map</li>
<li>堆(Heap)</li>
<li>双层桶划分</li>
<li>数据库索引</li>
<li>倒排索引（Inverted Index）</li>
<li>外排序</li>
<li>Trie树</li>
<li>MapReduce</li>
<li>CRDT: Conflict-free replicated data type</li>
<li>Append-Only</li>
<li>
<p>日志</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <a href="https://queue.acm.org/detail.cfm?id=3220266">Algorithms Behind Modern Storage Systems</a></p>
</li>
</ul>
<h3 id="crdt">CRDT</h3>
<p><a href="https://crdt.tech/">https://crdt.tech/</a></p>
<h3 id="_21">无锁</h3>
<p>无锁数据结构实现起来比较复杂，正确性证明也比较困难。如果已经证明了算法的正确性，还需要保证实现是正确的，可以通过大量并发测试来减少风险。</p>
<p>A non-blocking algorithm is lock-free if there is guaranteed system-wide progress, and wait-free if there is also guaranteed per-thread progress.
如果系统范围内进程可以有保证，则不阻塞的算法是无锁的。
如果进程中每个线程有保证，则不阻塞算法是无等待的。</p>
<p>wait-free 
无等待是进程的最有力的非阻塞保证，它将保证的全系统吞吐量与无饥饿结合起来。如果每个操作都对操作完成前算法将采取的步骤数有限制，则算法是无等待的。此属性对于实时系统至关重要，只要性能成本不太高，它总是很好拥有的。</p>
<p>lock-free 
无锁允许单个线程挨饿，但可以保证整个系统的吞吐量。如果在程序线程运行足够长的时间后，至少有一个线程取得了进展（对于某些合理的进度定义），则算法是无锁的。所有的无等待算法都是无锁的。如果一个线程持有锁后睡眠，如果其它线程则会阻塞，这种情况肯定是有锁的。</p>
<p><a href="https://en.wikipedia.org/wiki/Non-blocking_algorithm">https://en.wikipedia.org/wiki/Non-blocking_algorithm</a></p>
<p>Serializable, <strong>Lockless</strong>, Distributed: Isolation in CockroachDB</p>
<h3 id="hash">hash</h3>
<ul>
<li><a href="https://blog.codingnow.com/2019/04/concurrent_hash_map.html">并发 Hash Map 的实现</a></li>
<li>哈希树：叶子节点是数据，中间节点是 hash 值，不断向上计算 hash，通过比较 hash 节点的不同一层层往下找到对应的叶子的不同。也称之为Merkle_tree。写入时要生成整个树的代价还是比较高。</li>
<li>lock-free wait-free hash_table
    对hash表分区，不同分区加不同的锁，降低争用</li>
</ul>
<h3 id="_22">并行原理</h3>
<h4 id="_23">并行方式</h4>
<ol>
<li>
<p>节点间并行。MPP</p>
</li>
<li>
<p>节点内并行。SMP</p>
<ol>
<li>
<p>语句间并行（增加系统的处理吞吐量）</p>
</li>
<li>
<p>语句内并行（加快一条语句的处理速度）</p>
<p>算子内并行（单个算子并行）</p>
<p>算子间并行（不同的算子用不同线程实现，流水线）</p>
</li>
<li>
<p>指令级并行（向量化引擎+SIMD技术）</p>
<p>向量化引擎：将数据运载方式，由一次一元组变为一次一批元组。</p>
<p>SIMD：指令译码后多个寄存器同时访问内存，一次性获取多个操作数同时进行运算。</p>
<h5 id="mpp-join">MPP 并行 JOIN</h5>
</li>
</ol>
</li>
</ol>
<p>通过将部分数据哈希到对应的节点，然后各个节点并行做 JOIN 。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>(0) 定义
T1(id, v) hash(id)   
T2(id, v) hash(id)

DN1              DN2
T1 (1, 1)        T1 (2, 2)
T1 (3, 4)        T1 (4, 4)
T2 (1, 3)        T2 (2, 1)
T2 (3, 4)        T2 (4, 2)

T1 JOIN T2 on T1.id = T2.v

(1) 基于 hash(T2.v) 分发 T2 的数据

DN1              DN2
T1 (1, 1)        T1 (2, 2)
T1 (3, 4)        T1 (4, 4)
T2 (1, 3)-&gt;DN1   T2 (2, 1)-&gt;DN1
T2 (3, 4)-&gt;DN2   T2 (4, 2)-&gt;DN2

DN1              DN2
T1 (1, 1)        T1 (2, 2)
T1 (3, 3)        T1 (4, 4)
T2&#39; (1, 3)       T2&#39; (4, 2)
T2&#39; (2, 1)       T2&#39; (3, 4)

(2) 各个 DN 分别做 JOIN

DN1              DN2
(1, 1, 2, 1)     (2, 2, 4, 2)
(3, 3, 1, 3)     (4, 4, 3, 4)

(3) 汇总

(1, 1, 2, 1)
(2, 2, 4, 2)
(3, 3, 1, 3)
(4, 4, 3, 4)
</code></pre></div>

<h3 id="join">JOIN</h3>
<h4 id="_24">连接顺序</h4>
<p>结论1：JOIN的顺序影响中间结果的数据量，决定了JOIN的执行效率</p>
<p>结论2：JOIN的顺序影响具体JOIN算法的效率，决定了JOIN的执行效率</p>
<h4 id="_25">连接方式</h4>
<ol>
<li>内连接（相等连接，自然连接，交叉连接）</li>
<li>外连接（左连接，右连接，全连接）</li>
<li>自连接</li>
<li>连接算法（嵌套循环、合并连接、哈希连接）</li>
</ol>
<h4 id="_26">连接算法</h4>
<ol>
<li>nested loop：获取一条左表（outer）的记录循环匹配右表（inner）所有记录，外表驱动内表，外表也称之为驱动表。</li>
<li>Indexed nested loop：右边有索引，获取左表的一套记录，索引查找右表</li>
<li>merge join: 对于已经排序的表，可以用合并排序</li>
<li>hash join: 对同一个字段</li>
</ol>
<h5 id="nested-loop">nested loop</h5>
<div class="highlight"><pre><span></span><code>for ri in R1:         -- outer table
   for rj in R2:      -- inner table
      if ri.id = rj.id:
         print(ri,rj)
</code></pre></div>

<p>小表做驱动表（外表），大表做被驱动表（外表）。<br />
<div class="highlight"><pre><span></span><code><span class="n">t1</span><span class="p">:</span> <span class="mi">100</span>
<span class="n">t2</span><span class="p">:</span> <span class="mi">50000</span>
<span class="n">t2上有索引</span>
<span class="k">select</span> <span class="cm">/*+use_nl(t2,t1) leading(t2,t1)*/</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>  <span class="k">from</span> <span class="n">t2</span><span class="p">,</span><span class="n">t1</span> <span class="k">where</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>  <span class="c1">-- 2.697s 大表做驱动表</span>
<span class="k">select</span> <span class="cm">/*+use_nl(t1,t2) leading(t1,t2)*/</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>  <span class="k">from</span> <span class="n">t1</span><span class="p">,</span><span class="n">t2</span> <span class="k">where</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>  <span class="c1">-- 0.004s 小表做驱动表</span>
</code></pre></div></p>
<h5 id="hash-join">hash join</h5>
<p>被驱动表（右表，小表）先建立 hash 表，然后对另一个表中的元素散列到已经生成的桶中
<div class="highlight"><pre><span></span><code>for ri in R2:
    build_hash_table(HT, ri)

for rj in R1:
    probe(HT, rj)
</code></pre></div></p>
<p>并行hash算法：
1. 并行外表：外表分片，然后扫描内表（哈希表）；每个分片对应内表的一个哈希表，哈希表有多个拷贝，内表比较小的时候可用。
2. 并行哈希连接：并行扫描内表，多个线程并行建立一个共享的哈希表，多个线程并行扫描外表</p>
<div class="highlight"><pre><span></span><code><span class="k">insert</span> <span class="k">into</span> <span class="k">simple</span> <span class="k">select</span> <span class="n">generate_series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100000</span><span class="p">);</span>
<span class="k">analyze</span> <span class="k">simple</span><span class="p">;</span>
<span class="k">explain</span> <span class="p">(</span><span class="k">verbose</span><span class="p">,</span><span class="n">costs</span> <span class="k">off</span><span class="p">)</span>  <span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="k">simple</span> <span class="n">r</span> <span class="k">join</span> <span class="k">simple</span> <span class="n">s</span> <span class="k">using</span> <span class="p">(</span><span class="n">id</span><span class="p">);</span>
                             <span class="n">QUERY</span> <span class="n">PLAN</span>                             
<span class="c1">--------------------------------------------------------------------</span>
 <span class="n">Finalize</span> <span class="k">Aggregate</span>
   <span class="k">Output</span><span class="p">:</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
   <span class="o">-&gt;</span>  <span class="n">Gather</span>
         <span class="k">Output</span><span class="p">:</span> <span class="p">(</span><span class="k">PARTIAL</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">))</span>
         <span class="n">Workers</span> <span class="n">Planned</span><span class="p">:</span> <span class="mi">2</span>
         <span class="o">-&gt;</span>  <span class="k">Partial</span> <span class="k">Aggregate</span>
               <span class="k">Output</span><span class="p">:</span> <span class="k">PARTIAL</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
               <span class="o">-&gt;</span>  <span class="n">Parallel</span> <span class="n">Hash</span> <span class="k">Join</span>
                     <span class="n">Hash</span> <span class="n">Cond</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
                     <span class="o">-&gt;</span>  <span class="n">Parallel</span> <span class="n">Seq</span> <span class="n">Scan</span> <span class="k">on</span> <span class="k">public</span><span class="p">.</span><span class="k">simple</span> <span class="n">r</span>
                           <span class="k">Output</span><span class="p">:</span> <span class="n">r</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="ss">&quot;?column?&quot;</span>
                     <span class="o">-&gt;</span>  <span class="n">Parallel</span> <span class="n">Hash</span>
                           <span class="k">Output</span><span class="p">:</span> <span class="n">s</span><span class="p">.</span><span class="n">id</span>
                           <span class="o">-&gt;</span>  <span class="n">Parallel</span> <span class="n">Seq</span> <span class="n">Scan</span> <span class="k">on</span> <span class="k">public</span><span class="p">.</span><span class="k">simple</span> <span class="n">s</span>
                                 <span class="k">Output</span><span class="p">:</span> <span class="n">s</span><span class="p">.</span><span class="n">id</span>
<span class="p">(</span><span class="mi">15</span> <span class="k">rows</span><span class="p">)</span>

<span class="k">set</span> <span class="n">enable_hashjoin</span><span class="o">=</span><span class="k">off</span><span class="p">;</span>
<span class="k">set</span> <span class="n">enable_mergejoin</span><span class="o">=</span><span class="k">off</span><span class="p">;</span>
<span class="k">explain</span> <span class="p">(</span><span class="k">verbose</span><span class="p">,</span><span class="n">costs</span> <span class="k">off</span><span class="p">)</span>  <span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="k">simple</span> <span class="n">r</span> <span class="k">join</span> <span class="k">simple</span> <span class="n">s</span> <span class="k">using</span> <span class="p">(</span><span class="n">id</span><span class="p">);</span>
                          <span class="n">QUERY</span> <span class="n">PLAN</span>                          
<span class="c1">--------------------------------------------------------------</span>
 <span class="n">Finalize</span> <span class="k">Aggregate</span>
   <span class="k">Output</span><span class="p">:</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
   <span class="o">-&gt;</span>  <span class="n">Gather</span>
         <span class="k">Output</span><span class="p">:</span> <span class="p">(</span><span class="k">PARTIAL</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">))</span>
         <span class="n">Workers</span> <span class="n">Planned</span><span class="p">:</span> <span class="mi">2</span>
         <span class="o">-&gt;</span>  <span class="k">Partial</span> <span class="k">Aggregate</span>
               <span class="k">Output</span><span class="p">:</span> <span class="k">PARTIAL</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
               <span class="o">-&gt;</span>  <span class="n">Nested</span> <span class="n">Loop</span>
                     <span class="k">Join</span> <span class="n">Filter</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
                     <span class="o">-&gt;</span>  <span class="n">Parallel</span> <span class="n">Seq</span> <span class="n">Scan</span> <span class="k">on</span> <span class="k">public</span><span class="p">.</span><span class="k">simple</span> <span class="n">r</span>
                           <span class="k">Output</span><span class="p">:</span> <span class="n">r</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="ss">&quot;?column?&quot;</span>
                     <span class="o">-&gt;</span>  <span class="n">Seq</span> <span class="n">Scan</span> <span class="k">on</span> <span class="k">public</span><span class="p">.</span><span class="k">simple</span> <span class="n">s</span>
                           <span class="k">Output</span><span class="p">:</span> <span class="n">s</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="ss">&quot;?column?&quot;</span>
<span class="p">(</span><span class="mi">13</span> <span class="k">rows</span><span class="p">)</span>
<span class="c1">-- Gather节点后面的部分计划都是在子线程上处理</span>
<span class="c1">-- Parallel Seq Scan： 多个线程并行扫描，每个扫一部分</span>
<span class="c1">-- Seq Scan: 多个线程每个都是扫描全表</span>
</code></pre></div>

<p>参考PG的sql/join.sql测试文件</p>
<h5 id="merge-join">merge join</h5>
<p>两个表已经根据连接键排好序
1, 2, 2, 5, 8
2, 3, 5, 5, 7</p>
<p>左边右表按照最小的元素向后移动，如果相同则连接成功</p>
<h3 id="group-by">GROUP BY</h3>
<ol>
<li>hash group: 建立 hash 表，然后进行分组聚合</li>
<li>pipeline/stream: 基于排序，计算下一个分组时对前一个分组可以输出</li>
<li>sort group: 基于排序，但是先把所有数据插入到btree中；group by c1 order by c1 优化成 sort group by c1取消sort plan</li>
</ol>
<h2 id="_27">未来方向</h2>
<p>数据库会随着业务<strong>云化</strong>，未来一切的业务都会跑在云端，不管是私有云或者公有云，运维团队接触的可能再也不是真实的物理机，而是一个个隔离的容器或者「计算资源」。这对数据库也是一个挑战，因为数据库天生就是有状态的，数据总是要存储在物理的磁盘上，而数据的移动的代价比移动容器的代价可能大很多。</p>
<p><strong>多租户</strong>技术会成为标配，一个大数据库承载一切的业务，数据在底层打通，上层通过权限，容器等技术进行隔离；但是数据的打通和扩展会变得异常简单，结合第一点提到的云化，业务层可以再也不用关心物理机的容量和拓扑，只需要认为底层是一个无穷大的数据库平台即可，不用再担心单机容量和负载均衡等问题。</p>
<p><strong>OLAP 和 OLTP</strong> 会进一步细分，底层存储也许会共享一套，但是SQL优化器这层的实现一定是千差万别的。对于用户而言，如果能使用同一套标准的语法和规则来进行数据的读写和分析，会有更好的体验。</p>
<p>在未来分布式数据库系统上，主从日志同步这样落后的备份方式会被 Multi-Paxos / <strong>Raft</strong> 这样更强的分布式一致性算法替代，人工的数据库运维在管理大规模数据库集群时是不可能的，所有的故障恢复和高可用都会是高度自动化的。</p>
<p>数据库应用程序的下一个趋势是能够对新获取的数据执行分析查询和机器学习算法。这种通常也称为“实时分析”或者“混合事务分析处理（hybrid transaction-analytical processing，HTAP）”的应用通过分析新数据和历史数据的组合来进行知识推断，获得洞察力。</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2016 - 2021 iswade
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>